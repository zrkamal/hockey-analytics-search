import csv
import time
from pathlib import Path

QUERY_LOG_FILE = Path("data/query_log.csv")

# Initialize CSV if it doesn't exist
if not QUERY_LOG_FILE.exists():
    with open(QUERY_LOG_FILE, "w", newline="") as f:
        writer = csv.writer(f)
        writer.writerow(["timestamp", "query_type", "query", "num_results", "nodes_visited", "latency_ms"])

def log_query(query_type, query, num_results, nodes_visited, latency_ms):
    with open(QUERY_LOG_FILE, "a", newline="") as f:
        writer = csv.writer(f)
        writer.writerow([time.time(), query_type, query, num_results, nodes_visited, latency_ms])
1757100418.539799,prefix_search,Way,0,0,0.006200047209858894
1757100746.5868685,prefix_search,Way,0,0,0.00600004568696022
1757100750.359697,prefix_search,Way,0,0,0.0074999406933784485
1757101235.6693983,prefix_search,Way,0,0,0.007799826562404633
1757101368.322966,prefix_search,Way,0,0,0.008700182661414146
1757101763.9498649,prefix_search,Way,0,0,0.00819982960820198
1757101774.232113,prefix_search,Way,0,0,0.01309998333454132
